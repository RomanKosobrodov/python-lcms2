#define PY_SSIZE_T_CLEAN
#include <Python.h>
#include <numpy/ndarraytypes.h>
#include <lcms2.h>
#include <stdint.h> // standard types

typedef struct
{
    const char *key;
    uint32_t cms_type;
    const char *numpy_type;
    uint32_t channels;
} data_types_dictionary;

data_types_dictionary CMS_DATA_TYPES[] = {
    {"GRAY_8", TYPE_GRAY_8, "uint8", 1},
    {"GRAY_8_REV", TYPE_GRAY_8_REV, "uint8", 1},
    {"GRAY_16", TYPE_GRAY_16, "uint16", 1},
    {"GRAY_16_REV", TYPE_GRAY_16_REV, "uint16", 1},
    {"GRAY_16_SE", TYPE_GRAY_16_SE, "uint16", 1},
    {"GRAYA_8", TYPE_GRAYA_8, "uint8", 2},
    {"GRAYA_8_PREMUL", TYPE_GRAYA_8_PREMUL, "uint8", 2},
    {"GRAYA_16", TYPE_GRAYA_16, "uint16", 2},
    {"GRAYA_16_PREMUL", TYPE_GRAYA_16_PREMUL, "uint16", 2},
    {"GRAYA_16_SE", TYPE_GRAYA_16_SE, "uint16", 2},
    {"GRAYA_8_PLANAR", TYPE_GRAYA_8_PLANAR, "uint8", 2},
    {"GRAYA_16_PLANAR", TYPE_GRAYA_16_PLANAR, "uint16", 2},
    {"RGB_8", TYPE_RGB_8, "uint8", 3},
    {"RGB_8_PLANAR", TYPE_RGB_8_PLANAR, "uint8", 3},
    {"BGR_8", TYPE_BGR_8, "uint8", 3},
    {"BGR_8_PLANAR", TYPE_BGR_8_PLANAR, "uint8", 3},
    {"RGB_16", TYPE_RGB_16, "uint16", 3},
    {"RGB_16_PLANAR", TYPE_RGB_16_PLANAR, "uint16", 3},
    {"RGB_16_SE", TYPE_RGB_16_SE, "uint16", 3},
    {"BGR_16", TYPE_BGR_16, "uint16", 3},
    {"BGR_16_PLANAR", TYPE_BGR_16_PLANAR, "uint16", 3},
    {"BGR_16_SE", TYPE_BGR_16_SE, "uint16", 3},
    {"RGBA_8", TYPE_RGBA_8, "uint8", 4},
    {"RGBA_8_PREMUL", TYPE_RGBA_8_PREMUL, "uint8", 4},
    {"RGBA_8_PLANAR", TYPE_RGBA_8_PLANAR, "uint8", 4},
    {"RGBA_16", TYPE_RGBA_16, "uint16", 4},
    {"RGBA_16_PREMUL", TYPE_RGBA_16_PREMUL, "uint16", 4},
    {"RGBA_16_PLANAR", TYPE_RGBA_16_PLANAR, "uint16", 4},
    {"RGBA_16_SE", TYPE_RGBA_16_SE, "uint16", 4},
    {"ARGB_8", TYPE_ARGB_8, "uint8", 4},
    {"ARGB_8_PREMUL", TYPE_ARGB_8_PREMUL, "uint8", 4},
    {"ARGB_8_PLANAR", TYPE_ARGB_8_PLANAR, "uint8", 4},
    {"ARGB_16", TYPE_ARGB_16, "uint16", 4},
    {"ARGB_16_PREMUL", TYPE_ARGB_16_PREMUL, "uint16", 4},
    {"ABGR_8", TYPE_ABGR_8, "uint8", 4},
    {"ABGR_8_PREMUL", TYPE_ABGR_8_PREMUL, "uint8", 4},
    {"ABGR_8_PLANAR", TYPE_ABGR_8_PLANAR, "uint8", 4},
    {"ABGR_16", TYPE_ABGR_16, "uint16", 4},
    {"ABGR_16_PREMUL", TYPE_ABGR_16_PREMUL, "uint16", 4},
    {"ABGR_16_PLANAR", TYPE_ABGR_16_PLANAR, "uint16", 4},
    {"ABGR_16_SE", TYPE_ABGR_16_SE, "uint16", 4},
    {"BGRA_8", TYPE_BGRA_8, "uint8", 4},
    {"BGRA_8_PREMUL", TYPE_BGRA_8_PREMUL, "uint8", 4},
    {"BGRA_8_PLANAR", TYPE_BGRA_8_PLANAR, "uint8", 4},
    {"BGRA_16", TYPE_BGRA_16, "uint16", 4},
    {"BGRA_16_PREMUL", TYPE_BGRA_16_PREMUL, "uint16", 4},
    {"BGRA_16_SE", TYPE_BGRA_16_SE, "uint16", 4},
    {"CMY_8", TYPE_CMY_8, "uint8", 3},
    {"CMY_8_PLANAR", TYPE_CMY_8_PLANAR, "uint8", 3},
    {"CMY_16", TYPE_CMY_16, "uint16", 3},
    {"CMY_16_PLANAR", TYPE_CMY_16_PLANAR, "uint16", 3},
    {"CMY_16_SE", TYPE_CMY_16_SE, "uint16", 3},
    {"CMYK_8", TYPE_CMYK_8, "uint8", 4},
    {"CMYKA_8", TYPE_CMYKA_8, "uint8", 5},
    {"CMYK_8_REV", TYPE_CMYK_8_REV, "uint8", 4},
    {"YUVK_8", TYPE_YUVK_8, "uint8", 4},
    {"CMYK_8_PLANAR", TYPE_CMYK_8_PLANAR, "uint8", 4},
    {"CMYK_16", TYPE_CMYK_16, "uint16", 4},
    {"CMYK_16_REV", TYPE_CMYK_16_REV, "uint16", 4},
    {"YUVK_16", TYPE_YUVK_16, "uint16", 4},
    {"CMYK_16_PLANAR", TYPE_CMYK_16_PLANAR, "uint16", 4},
    {"CMYK_16_SE", TYPE_CMYK_16_SE, "uint16", 4},
    {"KYMC_8", TYPE_KYMC_8, "uint8", 4},
    {"KYMC_16", TYPE_KYMC_16, "uint16", 4},
    {"KYMC_16_SE", TYPE_KYMC_16_SE, "uint16", 4},
    {"KCMY_8", TYPE_KCMY_8, "uint8", 4},
    {"KCMY_8_REV", TYPE_KCMY_8_REV, "uint8", 4},
    {"KCMY_16", TYPE_KCMY_16, "uint16", 4},
    {"KCMY_16_REV", TYPE_KCMY_16_REV, "uint16", 4},
    {"KCMY_16_SE", TYPE_KCMY_16_SE, "uint16", 4},
    {"CMYK5_8", TYPE_CMYK5_8, "uint8", 4},
    {"CMYK5_16", TYPE_CMYK5_16, "uint16", 4},
    {"CMYK5_16_SE", TYPE_CMYK5_16_SE, "uint16", 4},
    {"KYMC5_8", TYPE_KYMC5_8, "uint8", 4},
    {"KYMC5_16", TYPE_KYMC5_16, "uint16", 4},
    {"KYMC5_16_SE", TYPE_KYMC5_16_SE, "uint16", 4},
    {"CMYK6_8", TYPE_CMYK6_8, "uint8", 4},
    {"CMYK6_8_PLANAR", TYPE_CMYK6_8_PLANAR, "uint8", 4},
    {"CMYK6_16", TYPE_CMYK6_16, "uint16", 4},
    {"CMYK6_16_PLANAR", TYPE_CMYK6_16_PLANAR, "uint16", 4},
    {"CMYK6_16_SE", TYPE_CMYK6_16_SE, "uint16", 4},
    {"CMYK7_8", TYPE_CMYK7_8, "uint8", 4},
    {"CMYK7_16", TYPE_CMYK7_16, "uint16", 4},
    {"CMYK7_16_SE", TYPE_CMYK7_16_SE, "uint16", 4},
    {"KYMC7_8", TYPE_KYMC7_8, "uint8", 4},
    {"KYMC7_16", TYPE_KYMC7_16, "uint16", 4},
    {"KYMC7_16_SE", TYPE_KYMC7_16_SE, "uint16", 4},
    {"CMYK8_8", TYPE_CMYK8_8, "uint8", 4},
    {"CMYK8_16", TYPE_CMYK8_16, "uint16", 4},
    {"CMYK8_16_SE", TYPE_CMYK8_16_SE, "uint16", 4},
    {"KYMC8_8", TYPE_KYMC8_8, "uint8", 4},
    {"KYMC8_16", TYPE_KYMC8_16, "uint16", 4},
    {"KYMC8_16_SE", TYPE_KYMC8_16_SE, "uint16", 4},
    {"CMYK9_8", TYPE_CMYK9_8, "uint8", 4},
    {"CMYK9_16", TYPE_CMYK9_16, "uint16", 4},
    {"CMYK9_16_SE", TYPE_CMYK9_16_SE, "uint16", 4},
    {"KYMC9_8", TYPE_KYMC9_8, "uint8", 4},
    {"KYMC9_16", TYPE_KYMC9_16, "uint16", 4},
    {"KYMC9_16_SE", TYPE_KYMC9_16_SE, "uint16", 4},
    {"CMYK10_8", TYPE_CMYK10_8, "uint8", 4},
    {"CMYK10_16", TYPE_CMYK10_16, "uint16", 4},
    {"CMYK10_16_SE", TYPE_CMYK10_16_SE, "uint16", 4},
    {"KYMC10_8", TYPE_KYMC10_8, "uint8", 4},
    {"KYMC10_16", TYPE_KYMC10_16, "uint16", 4},
    {"KYMC10_16_SE", TYPE_KYMC10_16_SE, "uint16", 4},
    {"CMYK11_8", TYPE_CMYK11_8, "uint8", 4},
    {"CMYK11_16", TYPE_CMYK11_16, "uint16", 4},
    {"CMYK11_16_SE", TYPE_CMYK11_16_SE, "uint16", 4},
    {"KYMC11_8", TYPE_KYMC11_8, "uint8", 4},
    {"KYMC11_16", TYPE_KYMC11_16, "uint16", 4},
    {"KYMC11_16_SE", TYPE_KYMC11_16_SE, "uint16", 4},
    {"CMYK12_8", TYPE_CMYK12_8, "uint8", 4},
    {"CMYK12_16", TYPE_CMYK12_16, "uint16", 4},
    {"CMYK12_16_SE", TYPE_CMYK12_16_SE, "uint16", 4},
    {"KYMC12_8", TYPE_KYMC12_8, "uint8", 4},
    {"KYMC12_16", TYPE_KYMC12_16, "uint16", 4},
    {"KYMC12_16_SE", TYPE_KYMC12_16_SE, "uint16", 4},
    {"XYZ_16", TYPE_XYZ_16, "uint16", 3},
    {"Lab_8", TYPE_Lab_8, "uint8", 3},
    {"LabV2_8", TYPE_LabV2_8, "uint8", 3},
    {"ALab_8", TYPE_ALab_8, "uint8", 4},
    {"ALabV2_8", TYPE_ALabV2_8, "uint8", 4},
    {"Lab_16", TYPE_Lab_16, "uint16", 3},
    {"LabV2_16", TYPE_LabV2_16, "uint16", 3},
    {"Yxy_16", TYPE_Yxy_16, "uint16", 3},
    {"YCbCr_8", TYPE_YCbCr_8, "uint8", 3},
    {"YCbCr_8_PLANAR", TYPE_YCbCr_8_PLANAR, "uint8", 3},
    {"YCbCr_16", TYPE_YCbCr_16, "uint16", 3},
    {"YCbCr_16_PLANAR", TYPE_YCbCr_16_PLANAR, "uint16", 3},
    {"YCbCr_16_SE", TYPE_YCbCr_16_SE, "uint16", 3},
    {"YUV_8", TYPE_YUV_8, "uint8", 3},
    {"YUV_8_PLANAR", TYPE_YUV_8_PLANAR, "uint8", 3},
    {"YUV_16", TYPE_YUV_16, "uint16", 3},
    {"YUV_16_PLANAR", TYPE_YUV_16_PLANAR, "uint16", 3},
    {"YUV_16_SE", TYPE_YUV_16_SE, "uint16", 3},
    {"HLS_8", TYPE_HLS_8, "uint8", 3},
    {"HLS_8_PLANAR", TYPE_HLS_8_PLANAR, "uint8", 3},
    {"HLS_16", TYPE_HLS_16, "uint16", 3},
    {"HLS_16_PLANAR", TYPE_HLS_16_PLANAR, "uint16", 3},
    {"HLS_16_SE", TYPE_HLS_16_SE, "uint16", 3},
    {"HSV_8", TYPE_HSV_8, "uint8", 3},
    {"HSV_8_PLANAR", TYPE_HSV_8_PLANAR, "uint8", 3},
    {"HSV_16", TYPE_HSV_16, "uint16", 3},
    {"HSV_16_PLANAR", TYPE_HSV_16_PLANAR, "uint16", 3},
    {"HSV_16_SE", TYPE_HSV_16_SE, "uint16", 3},
    {"NAMED_COLOR_INDEX", TYPE_NAMED_COLOR_INDEX, 0, 0},
    {"XYZ_FLT", TYPE_XYZ_FLT, "float32", 3},
    {"Lab_FLT", TYPE_Lab_FLT, "float32", 3},
    {"LabA_FLT", TYPE_LabA_FLT, "float32", 4},
    {"GRAY_FLT", TYPE_GRAY_FLT, "float32", 1},
    {"GRAYA_FLT", TYPE_GRAYA_FLT, "float32", 2},
    {"GRAYA_FLT_PREMUL", TYPE_GRAYA_FLT_PREMUL, "float32", 2},
    {"RGB_FLT", TYPE_RGB_FLT, "float32", 3},
    {"RGBA_FLT", TYPE_RGBA_FLT, "float32", 4},
    {"RGBA_FLT_PREMUL", TYPE_RGBA_FLT_PREMUL, "float32", 4},
    {"ARGB_FLT", TYPE_ARGB_FLT, "float32", 4},
    {"ARGB_FLT_PREMUL", TYPE_ARGB_FLT_PREMUL, "float32", 4},
    {"BGR_FLT", TYPE_BGR_FLT, "float32", 3},
    {"BGRA_FLT", TYPE_BGRA_FLT, "float32", 4},
    {"BGRA_FLT_PREMUL", TYPE_BGRA_FLT_PREMUL, "float32", 4},
    {"ABGR_FLT", TYPE_ABGR_FLT, "float32", 4},
    {"ABGR_FLT_PREMUL", TYPE_ABGR_FLT_PREMUL, "float32", 4},
    {"CMYK_FLT", TYPE_CMYK_FLT, "float32", 4},
    {"XYZ_DBL", TYPE_XYZ_DBL, "float64", 3},
    {"Lab_DBL", TYPE_Lab_DBL, "float64", 3},
    {"GRAY_DBL", TYPE_GRAY_DBL, "float64", 1},
    {"RGB_DBL", TYPE_RGB_DBL, "float64", 3},
    {"BGR_DBL", TYPE_BGR_DBL, "float64", 3},
    {"CMYK_DBL", TYPE_CMYK_DBL, "float64", 4},
    {"OKLAB_DBL", TYPE_OKLAB_DBL, "float64", 3},
    {"GRAY_HALF_FLT", TYPE_GRAY_HALF_FLT, "float16", 1},
    {"RGB_HALF_FLT", TYPE_RGB_HALF_FLT, "float16", 3},
    {"CMYK_HALF_FLT", TYPE_CMYK_HALF_FLT, "float16", 4},
    {"RGBA_HALF_FLT", TYPE_RGBA_HALF_FLT, "float16", 4},
    {"ARGB_HALF_FLT", TYPE_ARGB_HALF_FLT, "float16", 4},
    {"BGR_HALF_FLT", TYPE_BGR_HALF_FLT, "float16", 3},
    {"BGRA_HALF_FLT", TYPE_BGRA_HALF_FLT, "float16", 4},
    {"ABGR_HALF_FLT", TYPE_ABGR_HALF_FLT, "float16", 4},
    {NULL, 0}};

static PyObject *
create_data_types_dict()
{
    PyObject *d = PyDict_New();
    if (d == NULL)
        return NULL;
    int k = 0;
    while (CMS_DATA_TYPES[k].key != NULL)
    {
        PyDict_SetItemString(d, CMS_DATA_TYPES[k].key,
                             Py_BuildValue("[i, s, i]",
                                           CMS_DATA_TYPES[k].cms_type,
                                           CMS_DATA_TYPES[k].numpy_type,
                                           CMS_DATA_TYPES[k].channels));
        k += 1;
    }
    return d;
}